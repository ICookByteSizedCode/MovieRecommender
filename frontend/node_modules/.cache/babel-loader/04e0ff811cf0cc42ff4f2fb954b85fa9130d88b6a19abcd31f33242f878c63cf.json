{"ast":null,"code":"import React,{useEffect,useState}from'react';import Header from'../components/Header/Header.js';import ScrollableSection from'../components/ScrollableSection/ScrollableSection.js';import DisplayMovie from'./DisplayMovie.js';import styles from'../components/MovieRecommender/MovieRecommender.module.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function RecommendedMovies(_ref){let{userPreferences,favoriteMovies}=_ref;const[recs,setRecs]=useState([]);const[isLoading,setIsLoading]=useState(true);const[error,setError]=useState(null);const[selectedMovie,setSelectedMovie]=useState({});const[isEmpty,setIsEmpty]=useState(true);useEffect(()=>{const genreArr=globalThis.prefGen.map(genre=>genre.name);setIsEmpty(genreArr.length===0&&globalThis.prefLang.length===0&&globalThis.prefMov.length===0);const fetchRecs=async()=>{if(isEmpty){setIsLoading(false);}try{setIsLoading(true);const response=await fetch('http://127.0.0.1:3001/submit-preferences',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({selectedGenres:genreArr,selectedLanguages:globalThis.prefLang,selectedMovies:globalThis.prefMov})});if(!response.ok)throw new Error('Failed to Fetch');const data=await response.json();console.log(\"Fetched Recs:\",data);setRecs(data.map(movie=>({...movie,mov_id:movie.id,poster_path:movie.poster_path})));setIsLoading(false);}catch(err){console.error(\"Error fetching recs:\",err);setError(err.message);setIsLoading(false);}};fetchRecs();},[userPreferences,favoriteMovies]);const handleMovieClick=mov=>{console.log(\"movie data:\",mov);const options={method:'GET',headers:{accept:'application/json',Authorization:'Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJkMWNkNGQxYmE3YTU4YjE1MTM4MzVkOTM1YjI2YjJiZSIsInN1YiI6IjY1ZTc4OWY5NTFmOTlhMDE2MmZiYjc1NCIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.vnaq5VRSoFW0czZA-0ldClHBIEhL-PWg1P7NXFi6VeA'}};if(mov&&mov.mov_id){fetch('https://api.themoviedb.org/3/movie/'+mov[\"mov_id\"]+'?language=en-US',options).then(response=>response.json()).then(response=>{setSelectedMovie(response);}).catch(err=>console.error(err));}else{console.error(\"invalid movie id: \",mov);}};const handleBackClick=()=>{setSelectedMovie({});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(ScrollableSection,{children:isLoading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading recommendations...\"}):error?/*#__PURE__*/_jsxs(\"p\",{children:[\"Error: \",error]}):isEmpty?/*#__PURE__*/_jsx(\"p\",{children:\"Please add some favorites to see your personalized recommended movies!\"}):Object.keys(selectedMovie).length===0?/*#__PURE__*/_jsx(\"div\",{className:styles.movieRecommender,children:recs.map(movie=>/*#__PURE__*/_jsxs(\"div\",{className:styles.movieCard,onClick:()=>handleMovieClick(movie),children:[/*#__PURE__*/_jsx(\"img\",{src:movie['poster_path']=\"https://image.tmdb.org/t/p/original\"+movie['poster_path'],alt:movie.title}),/*#__PURE__*/_jsxs(\"div\",{className:styles.content,children:[/*#__PURE__*/_jsx(\"h3\",{children:movie.title}),/*#__PURE__*/_jsx(\"p\",{children:movie.description})]})]},movie.id))}):/*#__PURE__*/_jsxs(\"div\",{className:styles.centerComp,children:[/*#__PURE__*/_jsx(DisplayMovie,{movie:selectedMovie},new Date().getTime()),/*#__PURE__*/_jsx(\"button\",{onClick:handleBackClick,className:styles.backButton,children:\"Back to List\"})]})})]});}export default RecommendedMovies;","map":{"version":3,"names":["React","useEffect","useState","Header","ScrollableSection","DisplayMovie","styles","jsx","_jsx","jsxs","_jsxs","RecommendedMovies","_ref","userPreferences","favoriteMovies","recs","setRecs","isLoading","setIsLoading","error","setError","selectedMovie","setSelectedMovie","isEmpty","setIsEmpty","genreArr","globalThis","prefGen","map","genre","name","length","prefLang","prefMov","fetchRecs","response","fetch","method","headers","body","JSON","stringify","selectedGenres","selectedLanguages","selectedMovies","ok","Error","data","json","console","log","movie","mov_id","id","poster_path","err","message","handleMovieClick","mov","options","accept","Authorization","then","catch","handleBackClick","children","Object","keys","className","movieRecommender","movieCard","onClick","src","alt","title","content","description","centerComp","Date","getTime","backButton"],"sources":["/Users/stavkinreich/Desktop/Stav/CS520/COMPSCI520PROJECT3/frontend/src/pages/RecommendedMovies.js"],"sourcesContent":["import React, {useEffect, useState} from 'react';\nimport Header from '../components/Header/Header.js'\nimport ScrollableSection from '../components/ScrollableSection/ScrollableSection.js'\nimport DisplayMovie from './DisplayMovie.js';\nimport styles from '../components/MovieRecommender/MovieRecommender.module.css'\n\nfunction RecommendedMovies({ userPreferences, favoriteMovies }) {\n\n    const [recs, setRecs] = useState([]);\n\n    const [isLoading, setIsLoading] = useState(true);\n    const [error, setError] = useState(null);\n\n    const [selectedMovie, setSelectedMovie] = useState({})\n    const [isEmpty, setIsEmpty] = useState(true);\n\n    useEffect(() => {\n      const genreArr = globalThis.prefGen.map(genre => genre.name);\n      setIsEmpty(genreArr.length === 0 && globalThis.prefLang.length === 0 && globalThis.prefMov.length === 0);\n\n        const fetchRecs = async () => {\n          if (isEmpty) {\n            setIsLoading(false);\n          }\n            try {\n                setIsLoading(true);\n                const response = await fetch('http://127.0.0.1:3001/submit-preferences', {\n                    method: 'POST',\n                    headers: {'Content-Type': 'application/json'},\n                    body: JSON.stringify({\n                        selectedGenres: genreArr,\n                        selectedLanguages: globalThis.prefLang,\n                        selectedMovies: globalThis.prefMov })\n                });\n                if (!response.ok) throw new Error('Failed to Fetch');\n                const data = await response.json();\n                console.log(\"Fetched Recs:\", data);\n                setRecs(data.map(movie => ({\n                  ...movie,\n                  mov_id: movie.id,\n                  poster_path: movie.poster_path\n                })));\n                setIsLoading(false);\n            } catch (err) {\n                console.error(\"Error fetching recs:\", err);\n                setError(err.message);\n                setIsLoading(false);\n            }\n        }\n        fetchRecs();\n    }, [userPreferences, favoriteMovies])\n\n    const handleMovieClick = (mov) => {\n      console.log(\"movie data:\", mov);\n      const options = {\n            method: 'GET',\n            headers: {\n              accept: 'application/json',\n              Authorization: 'Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJkMWNkNGQxYmE3YTU4YjE1MTM4MzVkOTM1YjI2YjJiZSIsInN1YiI6IjY1ZTc4OWY5NTFmOTlhMDE2MmZiYjc1NCIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.vnaq5VRSoFW0czZA-0ldClHBIEhL-PWg1P7NXFi6VeA'\n            }\n          };\n      if (mov && mov.mov_id) {\n        fetch('https://api.themoviedb.org/3/movie/' + mov[\"mov_id\"] +'?language=en-US', options)\n          .then(response => response.json())\n          .then(response => {\n            setSelectedMovie(response);\n          })\n          .catch(err => console.error(err));\n      } else {\n        console.error(\"invalid movie id: \", mov);\n      }\n\n    }\n\n    const handleBackClick = () => {\n      setSelectedMovie({});\n    };\n\n  return (\n    <div>\n      <Header />\n        <ScrollableSection>\n          {isLoading ? (\n            <p>Loading recommendations...</p>\n          ) : error ? (\n            <p>Error: {error}</p> \n          ) : isEmpty ? (\n            <p>Please add some favorites to see your personalized recommended movies!</p>\n          ) : Object.keys(selectedMovie).length === 0 ? (\n            <div className={styles.movieRecommender}>\n              {recs.map((movie) =>\n                <div key={movie.id} className={styles.movieCard} onClick={() => handleMovieClick(movie)}>\n                  <img src={movie['poster_path'] = \"https://image.tmdb.org/t/p/original\" + movie['poster_path']} alt={movie.title} />\n                    <div className={styles.content}>\n                        <h3>{movie.title}</h3>\n                        <p>{movie.description}</p>\n                    </div>\n                </div>\n              )}\n            </div>\n          ) : (\n            <div className={styles.centerComp}>\n              <DisplayMovie key={new Date().getTime()} movie={selectedMovie} />\n              <button onClick={handleBackClick} className={styles.backButton}>Back to List</button>\n            </div>\n          )}\n        </ScrollableSection>\n    </div>\n    );\n  }\n\nexport default RecommendedMovies;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAGC,SAAS,CAAEC,QAAQ,KAAO,OAAO,CAChD,MAAO,CAAAC,MAAM,KAAM,gCAAgC,CACnD,MAAO,CAAAC,iBAAiB,KAAM,sDAAsD,CACpF,MAAO,CAAAC,YAAY,KAAM,mBAAmB,CAC5C,MAAO,CAAAC,MAAM,KAAM,4DAA4D,QAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE/E,QAAS,CAAAC,iBAAiBA,CAAAC,IAAA,CAAsC,IAArC,CAAEC,eAAe,CAAEC,cAAe,CAAC,CAAAF,IAAA,CAE1D,KAAM,CAACG,IAAI,CAAEC,OAAO,CAAC,CAAGd,QAAQ,CAAC,EAAE,CAAC,CAEpC,KAAM,CAACe,SAAS,CAAEC,YAAY,CAAC,CAAGhB,QAAQ,CAAC,IAAI,CAAC,CAChD,KAAM,CAACiB,KAAK,CAAEC,QAAQ,CAAC,CAAGlB,QAAQ,CAAC,IAAI,CAAC,CAExC,KAAM,CAACmB,aAAa,CAAEC,gBAAgB,CAAC,CAAGpB,QAAQ,CAAC,CAAC,CAAC,CAAC,CACtD,KAAM,CAACqB,OAAO,CAAEC,UAAU,CAAC,CAAGtB,QAAQ,CAAC,IAAI,CAAC,CAE5CD,SAAS,CAAC,IAAM,CACd,KAAM,CAAAwB,QAAQ,CAAGC,UAAU,CAACC,OAAO,CAACC,GAAG,CAACC,KAAK,EAAIA,KAAK,CAACC,IAAI,CAAC,CAC5DN,UAAU,CAACC,QAAQ,CAACM,MAAM,GAAK,CAAC,EAAIL,UAAU,CAACM,QAAQ,CAACD,MAAM,GAAK,CAAC,EAAIL,UAAU,CAACO,OAAO,CAACF,MAAM,GAAK,CAAC,CAAC,CAEtG,KAAM,CAAAG,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC5B,GAAIX,OAAO,CAAE,CACXL,YAAY,CAAC,KAAK,CAAC,CACrB,CACE,GAAI,CACAA,YAAY,CAAC,IAAI,CAAC,CAClB,KAAM,CAAAiB,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,0CAA0C,CAAE,CACrEC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CAAC,cAAc,CAAE,kBAAkB,CAAC,CAC7CC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACjBC,cAAc,CAAEjB,QAAQ,CACxBkB,iBAAiB,CAAEjB,UAAU,CAACM,QAAQ,CACtCY,cAAc,CAAElB,UAAU,CAACO,OAAQ,CAAC,CAC5C,CAAC,CAAC,CACF,GAAI,CAACE,QAAQ,CAACU,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,iBAAiB,CAAC,CACpD,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAZ,QAAQ,CAACa,IAAI,CAAC,CAAC,CAClCC,OAAO,CAACC,GAAG,CAAC,eAAe,CAAEH,IAAI,CAAC,CAClC/B,OAAO,CAAC+B,IAAI,CAACnB,GAAG,CAACuB,KAAK,GAAK,CACzB,GAAGA,KAAK,CACRC,MAAM,CAAED,KAAK,CAACE,EAAE,CAChBC,WAAW,CAAEH,KAAK,CAACG,WACrB,CAAC,CAAC,CAAC,CAAC,CACJpC,YAAY,CAAC,KAAK,CAAC,CACvB,CAAE,MAAOqC,GAAG,CAAE,CACVN,OAAO,CAAC9B,KAAK,CAAC,sBAAsB,CAAEoC,GAAG,CAAC,CAC1CnC,QAAQ,CAACmC,GAAG,CAACC,OAAO,CAAC,CACrBtC,YAAY,CAAC,KAAK,CAAC,CACvB,CACJ,CAAC,CACDgB,SAAS,CAAC,CAAC,CACf,CAAC,CAAE,CAACrB,eAAe,CAAEC,cAAc,CAAC,CAAC,CAErC,KAAM,CAAA2C,gBAAgB,CAAIC,GAAG,EAAK,CAChCT,OAAO,CAACC,GAAG,CAAC,aAAa,CAAEQ,GAAG,CAAC,CAC/B,KAAM,CAAAC,OAAO,CAAG,CACVtB,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACPsB,MAAM,CAAE,kBAAkB,CAC1BC,aAAa,CAAE,4NACjB,CACF,CAAC,CACL,GAAIH,GAAG,EAAIA,GAAG,CAACN,MAAM,CAAE,CACrBhB,KAAK,CAAC,qCAAqC,CAAGsB,GAAG,CAAC,QAAQ,CAAC,CAAE,iBAAiB,CAAEC,OAAO,CAAC,CACrFG,IAAI,CAAC3B,QAAQ,EAAIA,QAAQ,CAACa,IAAI,CAAC,CAAC,CAAC,CACjCc,IAAI,CAAC3B,QAAQ,EAAI,CAChBb,gBAAgB,CAACa,QAAQ,CAAC,CAC5B,CAAC,CAAC,CACD4B,KAAK,CAACR,GAAG,EAAIN,OAAO,CAAC9B,KAAK,CAACoC,GAAG,CAAC,CAAC,CACrC,CAAC,IAAM,CACLN,OAAO,CAAC9B,KAAK,CAAC,oBAAoB,CAAEuC,GAAG,CAAC,CAC1C,CAEF,CAAC,CAED,KAAM,CAAAM,eAAe,CAAGA,CAAA,GAAM,CAC5B1C,gBAAgB,CAAC,CAAC,CAAC,CAAC,CACtB,CAAC,CAEH,mBACEZ,KAAA,QAAAuD,QAAA,eACEzD,IAAA,CAACL,MAAM,GAAE,CAAC,cACRK,IAAA,CAACJ,iBAAiB,EAAA6D,QAAA,CACfhD,SAAS,cACRT,IAAA,MAAAyD,QAAA,CAAG,4BAA0B,CAAG,CAAC,CAC/B9C,KAAK,cACPT,KAAA,MAAAuD,QAAA,EAAG,SAAO,CAAC9C,KAAK,EAAI,CAAC,CACnBI,OAAO,cACTf,IAAA,MAAAyD,QAAA,CAAG,wEAAsE,CAAG,CAAC,CAC3EC,MAAM,CAACC,IAAI,CAAC9C,aAAa,CAAC,CAACU,MAAM,GAAK,CAAC,cACzCvB,IAAA,QAAK4D,SAAS,CAAE9D,MAAM,CAAC+D,gBAAiB,CAAAJ,QAAA,CACrClD,IAAI,CAACa,GAAG,CAAEuB,KAAK,eACdzC,KAAA,QAAoB0D,SAAS,CAAE9D,MAAM,CAACgE,SAAU,CAACC,OAAO,CAAEA,CAAA,GAAMd,gBAAgB,CAACN,KAAK,CAAE,CAAAc,QAAA,eACtFzD,IAAA,QAAKgE,GAAG,CAAErB,KAAK,CAAC,aAAa,CAAC,CAAG,qCAAqC,CAAGA,KAAK,CAAC,aAAa,CAAE,CAACsB,GAAG,CAAEtB,KAAK,CAACuB,KAAM,CAAE,CAAC,cACjHhE,KAAA,QAAK0D,SAAS,CAAE9D,MAAM,CAACqE,OAAQ,CAAAV,QAAA,eAC3BzD,IAAA,OAAAyD,QAAA,CAAKd,KAAK,CAACuB,KAAK,CAAK,CAAC,cACtBlE,IAAA,MAAAyD,QAAA,CAAId,KAAK,CAACyB,WAAW,CAAI,CAAC,EACzB,CAAC,GALAzB,KAAK,CAACE,EAMX,CACP,CAAC,CACE,CAAC,cAEN3C,KAAA,QAAK0D,SAAS,CAAE9D,MAAM,CAACuE,UAAW,CAAAZ,QAAA,eAChCzD,IAAA,CAACH,YAAY,EAA4B8C,KAAK,CAAE9B,aAAc,EAA3C,GAAI,CAAAyD,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAA0B,CAAC,cACjEvE,IAAA,WAAQ+D,OAAO,CAAEP,eAAgB,CAACI,SAAS,CAAE9D,MAAM,CAAC0E,UAAW,CAAAf,QAAA,CAAC,cAAY,CAAQ,CAAC,EAClF,CACN,CACgB,CAAC,EACnB,CAAC,CAER,CAEF,cAAe,CAAAtD,iBAAiB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}